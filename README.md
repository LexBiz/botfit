# BOTFIT — Telegram AI-нутриционист (GPT‑5.2 + БД)

Персональный Telegram‑бот нутрициолога с “памятью” через БД (не через ChatGPT memory):
- первичная анкета (10 вопросов) → расчёт нормы калорий и БЖУ → сохранение профиля
- дневник питания: текст / голос (опционально) / фото еды
- анализ фото: тип блюда, вес, способ приготовления, скрытые калории, уточняющие вопросы → КБЖУ
- расчёт рецепта по ингредиентам (общие/на 100г)
- рацион на день для Чехии (магазины: Lidl, Kaufland, Albert) под цель и норму
- анализ дневника за 7 дней, поиск ошибок, рекомендации, корректировка нормы с учетом прогресса

## Требования
- **Python 3.11 или 3.12** (рекомендую 3.11)
- Telegram Bot Token
- OpenAI API key (модель: `gpt-5.2`)

> Важно: на Python 3.14 сейчас часто нет готовых wheels для зависимостей (`pydantic-core`, иногда `aiohttp`), и установка падает, требуя Rust/MSVC. Если у тебя `py --version` показывает 3.14 — поставь Python 3.11 и запускай через `py -3.11`.

## Быстрый старт (Windows cmd)

```bat
cd C:\Users\Artem\Desktop\work\moi\BOTFIT
py -3.11 -m venv .venv
.venv\Scripts\activate
pip install -r requirements.txt
copy env.example .env
notepad .env
py -m src.bot
```

## Переменные окружения
Смотри `env.example`:
- `BOT_TOKEN`
- `OPENAI_API_KEY`
- `OPENAI_TEXT_MODEL` / `OPENAI_VISION_MODEL` (по умолчанию `gpt-5.2`)
- `OPENAI_TRANSCRIBE_MODEL` (для голосовых; по умолчанию `gpt-4o-mini-transcribe`)

## “Память” технически
Хранится в `data/botfit.sqlite3`:
- `users` — профиль и текущий шаг анкеты/диалогов
- `preferences` — предпочтения (магазины/страна/и т.п.)
- `meals` — приемы пищи (включая фото/сырой текст/структуру)
- `stats` — недельные агрегаты/прогресс
- `plans` — планы питания по дням

## Важно
- Для voice→text нужен `ffmpeg` в PATH (или `FFMPEG_PATH` в `.env`). Без него бот попросит прислать текстом.

## Команды бота
- `/start` — анкета
- `/profile` — профиль
- `/weight 82.5` — обновить вес
- `/plan` — рацион на день
- `/week` — анализ дневника за 7 дней
- `/recipe` — расчет рецепта по ингредиентам
- `/help` — подсказка

